<!DOCTYPE html>

<html>

<head>
  <title>To Do List</title>
  <link rel="stylesheet" href="css/index.css">
  <style>
    table,
    th,
    td {
      border: 1px solid black;
      border-collapse: collapse;
    }
  </style>
</head>

<body>
  <table id="table">
    <tr>
      <th width="100px">To Do List</th>
    </tr>
    <tr>
      <td>ID</td>
      <td width="100px">Name</td>
    </tr>
  </table>
  <input type="text" id="id"/>
  <input type="text" id="name"/>
  <button id="submit">Add</button>
  <button id="delete">Delete</button>
</body>
<script>
  console.log("Hello World");
  fetch('http://127.0.0.1:8000/get/')
    .then(response => response.json())
    .then(data => {
      console.log(data)
      data.forEach(item => {
        const row = document.createElement('tr')
        row.innerHTML = `<td>${item.id}</td><td>${item.name}</td>`
        document.getElementById('table').appendChild(row)
      })
    })
    .catch(error => console.error('Error:', error));

  document.getElementById('submit').addEventListener('click', () => {
    console.log(document.getElementById('id').value)
    console.log(document.getElementById('name').value)

    fetch('http://127.0.0.1:8000/add/', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        id: document.getElementById('id').value,
        name: document.getElementById('name').value
      })
    })
    .then(response => response.json())
    .then(data => {
      console.log('Success:', data);
      // 刷新页面或重新加载数据
      location.reload();
    })
    .catch(error => console.error('Error:', error));
  });
  
  document.getElementById('delete').addEventListener('click', () => {
    fetch('http://127.0.0.1:8000/delete/', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
      },
      body: JSON.stringify({
        id: document.getElementById('id').value,
        name: document.getElementById('name').value
      })
    })
      
      .then(response => response.json())    
      .then(data => {
      console.log('Success:', data);
      // 刷新页面或重新加载数据
      location.reload();
    })
    .catch(error => console.error('Error:', error));
  });

  
</script>

</html>